function vals = glquad(f, a, b, n)
% Returns the approximation of \int_a^bfdx with m = 2:n points.
% Quadrature Lookup Tables.
quadtables = { ... Entries take the form xj wj
    [],  ... n = 1
    [    ... n = 2
        -0.5773502692 1.0; ...
        +0.5773502692 1.0; ...
    ], [ ... n = 3
        -0.7745966692 0.5555555556; ...
        +0.7745966692 0.5555555556; ...
         0.0          0.8888888889; ...
    ], [ ... n = 4
        -0.8611363116 0.3478548451; ...
        +0.8611363116 0.3478548451; ...
        -0.3399810436 0.6521451549; ...
        +0.3399810436 0.6521451549; ...
    ], [ ... n = 5
        -0.9061798459 0.2369268851; ...
        +0.9061798459 0.2369268851; ...
        -0.5384693101 0.4786286705; ...
        +0.5384693101 0.4786286705; ...
         0.0          0.5688888889; ...
    ], [ ... n = 6
        -0.9324695142 0.1713244924; ...
        +0.9324695142 0.1713244924; ...
        -0.6612093865 0.3607615730; ...
        +0.6612093865 0.3607615730; ...
        -0.2386191861 0.4679139346; ...
        +0.2386191861 0.4679139346; ...
    ], [ ... n = 7
        -0.9491079123 0.1294849662; ...
        +0.9491079123 0.1294849662; ...
        -0.7415311856 0.2797053915; ...
        +0.7415311856 0.2797053915; ...
        -0.4058451514 0.3818300505; ...
        +0.4058451514 0.3818300505; ...
         0.0          0.4179591837; ...
    ], [ ... n = 8
        -0.9602898565 0.1012285363; ...
        +0.9602898565 0.1012285363; ...
        -0.7966664774 0.2223810345; ...
        +0.7966664774 0.2223810345; ...
        -0.5255324099 0.3137066459; ...
        +0.5255324099 0.3137066459; ...
        -0.1834346425 0.3626837834; ...
        +0.1834346425 0.3626837834; ...
    ] ...   
};

vals = zeros(1, length(n));
for i = 1:length(n)
    vals(i) = (b-a)/2 * sum(quadtables{n(i)}(:, 2) .* ...
        f((quadtables{n(i)}(:, 1) + 1)/2*(b-a) + a));
end
end